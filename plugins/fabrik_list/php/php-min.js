/*! Fabrik */
var FbListPHP=my.Class(FbListPlugin,{constructor:function(a){FbListPHP.Super.call(this,a)},buttonAction:function(event){var additional_data=this.options.additional_data,hdata={},rowIndexes=[],ok,elname,i,cell_data;this.list.getForm().getElements("input[name^=ids]").each(function(a){if(a.checked){ok=!0;var b=a.name.match(/ids\[(\d+)\]/)[1];if(rowIndexes.push(b),additional_data){hdata.hasOwnProperty(b)||(hdata[b]={}),hdata[b].rowid=a.value;var c=additional_data.split(",");for(i=0;i<c.length;i++)elname=c[i],cell_data=a.closest(".fabrik_row").getElements("td.fabrik_row___"+elname)[0].innerHTML,hdata[b][elname]=cell_data}}});for(var rows=[],g=0;g<this.list.options.data.length;g++)for(var r=0;r<this.list.options.data[g].length;r++){var row=this.list.options.data[g][r].data;-1!==rowIndexes.indexOf(row.__pk_val)&&rows.push(row)}if(additional_data&&this.list.getForm().find("input[name=fabrik_listplugin_options]").val(Json.encode(hdata)),""!==this.options.js_code){var result=eval("(function() {"+this.options.js_code+"}())");if(result===!1)return}this.list.submit("list.doPlugin")}});