/*! Fabrik */
var FbThumbs=my.Class(FbElement,{constructor:function(a,b,c){this.field=$("#"+a),FbThumbs.Super.call(this,a,b),this.thumb=c,this.spinner=new Spinner(this.getContainer()),this.setupj3()},setupj3:function(){var a,b=this.getContainer(),c=b.find("button.thumb-up"),d=b.find("button.thumb-down"),e=this;c.addEvent("click",function(b){b.stopPropagation(),e.options.canUse?(a=c.hasClass("btn-success")?!1:!0,e.doAjax("up",a),a?(c.addClass("btn-success"),d.removeClass("btn-danger")):c.removeClass("btn-success")):e.doNoAccess()}),d.addEvent("click",function(b){b.stopPropagation(),e.options.canUse?(a=d.hasClass("btn-danger")?!1:!0,e.doAjax("down",a),a?(d.addClass("btn-danger"),c.removeClass("btn-success")):d.removeClass("btn-danger")):e.doNoAccess()})},doAjax:function(a,b){if(b=b?!0:!1,this.options.editable===!1){this.spinner.show();var c={option:"com_fabrik",format:"raw",task:"plugin.pluginAjax",plugin:"thumbs",method:"ajax_rate",g:"element",element_id:this.options.elid,row_id:this.options.row_id,elementname:this.options.elid,userid:this.options.userid,thumb:a,listid:this.options.listid,formid:this.options.formid,add:b};new $.ajax({url:"",data:c}).done(function(a){if(a=JSON.decode(a),this.spinner.hide(),a.error)console.log(a.error);else if(""!==a){var b=this.getContainer();b.find("button.thumb-up .thumb-count").text(a[0]),b.find("button.thumb-down .thumb-count").text(a[1])}})}},doNoAccess:function(){""!==this.options.noAccessMsg&&window.alert(this.options.noAccessMsg)}});