/*! Fabrik */
var History=my.Class({constructor:function(a,b){var c=this;this.recording=!0,this.pointer=-1,$(a).on("click",function(a){c.undo(a)}),$(b).on("click",function(a){c.redo(a)}),Fabrik.addEvent("fabrik.history.on",function(a){c.on(a)}),Fabrik.addEvent("fabrik.history.off",function(a){c.off(a)}),Fabrik.addEvent("fabrik.history.add",function(a){c.add(a)}),this.history=[]},undo:function(){if(this.pointer>-1){this.off();{var a=this.history[this.pointer],b=a.undofunc,c=a.undoparams;b.attempt(c,a.object)}this.on(),this.pointer--}},redo:function(){if(this.pointer<this.history.length-1){this.pointer++,this.off();{var a=this.history[this.pointer],b=a.redofunc,c=a.redoparams;b.attempt(c,a.object)}this.on()}},add:function(a,b,c,d,e){var f=this;if(this.recording){var g=this.history.filter(function(a,b){return b<=f.pointer});this.history=g,this.history.push({object:a,undofunc:b,undoparams:c,redofunc:d,redoparams:e}),this.pointer++}},on:function(){this.recording=!0},off:function(){this.recording=!1}});