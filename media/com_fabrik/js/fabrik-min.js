/*! Fabrik */
function fconsole(){if("undefined"!=typeof window.console){var a,b="";for(a=0;a<arguments.length;a++)b+=arguments[a]+" ";console.log(b)}}var $=jQuery,RequestQueue=my.Class({queue:{},constructor:function(){var a=this;this.periodical=setInterval(function(){a.processQueue.call(a,!0)},500)},add:function(a){var b=a.options.url+Object.toQueryString(a.options.data)+Math.random();this.queue[b]||(this.queue[b]=a)},processQueue:function(){if(0!==Object.keys(this.queue).length){var a=!1;jQuery.each(this.queue,function(b,c){c.isSuccess()&&(delete this.queue[b],a=!1)}.bind(this)),jQuery.each(this.queue,function(b,c){c.isRunning()||c.isSuccess()||a||(c.send(),a=!0)})}},empty:function(){return 0===Object.keys(this.queue).length}});Request.HTML=my.Class(Request,{options:{update:!1,append:!1,evalScripts:!0,filter:!1,headers:{Accept:"text/html, application/xml, text/xml, */*"}},success:function(a){var b=this.options,c=this.response;c.html=a.stripScripts(function(a){c.javascript=a});var d=c.html.match(/<body[^>]*>([\s\S]*?)<\/body>/i);d&&(c.html=d[1]);var e=$("<div />").html(c.html);if(c.tree=e.childNodes,c.elements=e.getElements(b.filter||"*"),b.filter&&(c.tree=c.elements),b.update){var f=document.id(b.update).empty();b.filter?f.append(c.elements):f.html(c.html)}else if(b.append){var g=document.id(b.append);b.filter?c.elements.reverse().inject(g):g.append(e.getChildren())}b.evalScripts&&Browser.exec(c.javascript),this.onSuccess(c.tree,c.elements,c.html,c.javascript)}}),Array.prototype.searchFor=function(a){var b;for(b=0;b<this.length;b++)if(0===this[b].indexOf(a))return b;return-1};var Loader=my.Class({constructor:function(){this.spinners={},this.spinnerCount={}},start:function(a,b){if("null"===typeOf(document.id(a))&&(a=!1),a=a?a:document.body,b=b?b:Joomla.JText._("COM_FABRIK_LOADING"),this.spinners[a]||(this.spinners[a]=new Spinner(a,{message:b})),this.spinnerCount[a]?this.spinnerCount[a]++:this.spinnerCount[a]=1,1===this.spinnerCount[a])try{this.spinners[a].position().show()}catch(c){}},stop:function(a){if("null"===typeOf(document.id(a))&&(a=!1),a=a?a:document.body,this.spinners[a]&&this.spinnerCount[a]){if(this.spinnerCount[a]>1)return void this.spinnerCount[a]--;var b=this.spinners[a];Browser.ie&&Browser.version<9?b.hide():(b.destroy(),delete this.spinnerCount[a],delete this.spinners[a])}}});"undefined"==typeof Fabrik&&("undefined"!=typeof jQuery&&jQuery(document).on("click",".popover button.close",function(){var a="#"+$(this).data("popover"),b=$(a);jQuery(a).popover("hide"),"null"!==typeOf(b)&&"INPUT"===b.prop("tagName")&&b.prop("checked",!1)}),Fabrik={},Fabrik.events={},Fabrik.bootstrapVersion=function(a){a=a||"modal";var b=jQuery.fn[a];if(b){if(b.VERSION)return b.VERSION;if("modal"===a)return-1===b.toString().indexOf("bs.modal")?"2.x":"3.x"}},Fabrik.Windows={},Fabrik.loader=new Loader,Fabrik.blocks={},Fabrik.periodicals={},Fabrik.addBlock=function(a,b){Fabrik.blocks[a]=b,Fabrik.trigger("fabrik.block.added",[b,a])},Fabrik.getBlock=function(a,b,c){return c=c?c:!1,c&&(Fabrik.periodicals[a]=setInterval(function(){Fabrik._getBlock(this,[a,b,c])},500)),Fabrik._getBlock(a,b,c)},Fabrik._getBlock=function(a,b,c){var d;if(b=b?b:!1,void 0!==Fabrik.blocks[a])d=a;else{if(b)return!1;var e=Object.keys(Fabrik.blocks),f=e.searchFor(a);if(-1===f)return!1;d=e[f]}return c&&(clearInterval(Fabrik.periodicals[a]),c(Fabrik.blocks[d])),Fabrik.blocks[d]},jQuery(document).on("click",".fabrik_delete a, .fabrik_action a.delete, .btn.delete",function(a,b){a.rightClick||Fabrik.watchDelete(a,b)}),jQuery(document).on("click",".fabrik_edit a, a.fabrik_edit",function(a,b){a.rightClick||Fabrik.watchEdit(a,b)}),jQuery(document).on("click",".fabrik_view a, a.fabrik_view",function(a,b){a.rightClick||Fabrik.watchView(a,b)}),jQuery(document).on("click","*[data-fabrik-view]",function(a){if(!a.rightClick){var b,c,d;a.preventDefault(),c="A"===$(a.target).prop("tagName")?a.target:$(this).find("a").length>0?$(this).find("a"):$(this).closest("a"),b=c.prop("href"),b+=b.contains("?")?"&tmpl=component&ajax=1":"?tmpl=component&ajax=1",jQuery.each(Fabrik.Windows,function(a,b){b.close()}),d=c.get("title"),d||(d=Joomla.JText._("COM_FABRIK_VIEW"));var e={id:"view."+b,title:d,loadMethod:"xhr",contentURL:b};Fabrik.getWindow(e)}}),Fabrik.removeEvent=function(a,b){if(Fabrik.events[a]){var c=Fabrik.events[a].indexOf(b);-1!==c&&delete Fabrik.events[a][c]}},Fabrik.addEvent=function(a,b){Fabrik.events[a]||(Fabrik.events[a]=[]),-1===Fabrik.events[a].indexOf(b)&&Fabrik.events[a].push(b)},Fabrik.addEvents=function(a){var b;for(b in a)a.hasOwnProperty(b)&&Fabrik.addEvent(b,a[b]);return this},Fabrik.trigger=function(a,b,c){var d=Fabrik.events;return this.eventResults=[],d&&d[a]?(b=Array.from(b),d[a].each(function(a){this.eventResults.push(c?a.delay(c,this,b):a.apply(this,b))},this),this):this},Fabrik.requestQueue=new RequestQueue,Fabrik.cbQueue={google:[]},Fabrik.loadGoogleMap=function(a,b){var c="https:"===document.location.protocol?"https:":"http:",d=c+"//maps.googleapis.com/maps/api/js?&sensor="+a+"&libraries=places&callback=Fabrik.mapCb",e=Array.from(document.scripts).filter(function(a){return a.src===d});if(0===e.length){var f=document.createElement("script");f.type="text/javascript",f.src=d,document.body.appendChild(f),Fabrik.cbQueue.google.push(b)}else Fabrik.googleMap?window[b]():Fabrik.cbQueue.google.push(b)},Fabrik.mapCb=function(){Fabrik.googleMap=!0;var a,b;for(b=0;b<Fabrik.cbQueue.google.length;b++)a=Fabrik.cbQueue.google[b],"function"===typeOf(a)?a():window[a]();Fabrik.cbQueue.google=[]},Fabrik.watchDelete=function(a,b){var c,d,e;if(e=$(a.target).closest(".fabrik_row"),e||(e=Fabrik.activeRow),e){var f=e.find("input[type=checkbox][name*=id]");f.length>0&&(f.checked=!0),d=e.id.split("_"),d=d.splice(0,d.length-2).join("_"),c=Fabrik.blocks[d]}else if(d=$(a.target).closest(".fabrikList"),d.length>0)d=d.id,c=Fabrik.blocks[d];else{var g=b.closest(".floating-tip-wrapper");if(g.length>0){var h=g.data("list");d=h.id}else d=b.data("listRef");c=Fabrik.blocks[d],"floating"!==c.options.actionMethod||this.bootstrapped||c.form.getElements("input[type=checkbox][name*=id], input[type=checkbox][name=checkAll]").each(function(a){a.checked=!0})}c.submit("list.delete")||a.stopPropagation()},Fabrik.watchEdit=function(a,b){Fabrik.openSingleView("form",a,b)},Fabrik.watchView=function(a,b){Fabrik.openSingleView("details",a,b)},Fabrik.openSingleView=function(a,b,c){var d,e,f="xhr",g=c.data("list"),h=Fabrik.blocks[g];if(h.options.ajax_links){b.preventDefault();var i=h.getActiveRow(b);if(i){h.setActive(i);var j=i.id.split("_").pop();e="A"===$(b.target).prop("tagName")?$(b.target):$(b.target).find("a").length>0?$(b.target).find("a"):$(b.target).closest("a"),d=e.prop("href"),d+=d.contains("?")?"&tmpl=component&ajax=1":"?tmpl=component&ajax=1",f=e.data("loadmethod"),"null"===typeOf(f)&&(f="xhr"),jQuery(Fabrik.Windows,function(a,b){b.close()});var k={id:g+"."+j,title:h.options.popup_view_label,loadMethod:f,contentURL:d,width:h.options.popup_width,height:h.options.popup_height,onClose:function(){var b=a+"_"+h.options.formid+"_"+j;try{Fabrik.blocks[b].destroyElements(),Fabrik.blocks[b].formElements=null,Fabrik.blocks[b]=null,delete Fabrik.blocks[b];var c="details"===a?"fabrik.list.row.view.close":"fabrik.list.row.edit.close";Fabrik.trigger(c,[g,j,b])}catch(d){console.log(d)}}};k.id="details"===a?"view."+k.id:"add."+k.id,"null"!==typeOf(h.options.popup_offset_x)&&(k.offset_x=h.options.popup_offset_x),"null"!==typeOf(h.options.popup_offset_y)&&(k.offset_y=h.options.popup_offset_y),Fabrik.getWindow(k)}}},Fabrik.form=function(a,b,c){var d=new FbForm(b,c);return Fabrik.addBlock(a,d),d},$(window).trigger("fabrik.loaded")),Object.keys||(Object.keys=function(a){if(a!==Object(a))throw new TypeError("Object.keys called on a non-object");var b,c=[];for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&c.push(b);return c}),Array.prototype.filter||(Array.prototype.filter=function(a){"use strict";if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=[],e=arguments.length>=2?arguments[1]:void 0,f=0;c>f;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d});